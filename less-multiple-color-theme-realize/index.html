<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css"><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js"></script><script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;hiyangguo.com&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Pisces&quot;,&quot;version&quot;:&quot;8.3.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:true,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;},&quot;path&quot;:&quot;&#x2F;search.xml&quot;,&quot;localsearch&quot;:{&quot;enable&quot;:true,&quot;trigger&quot;:&quot;auto&quot;,&quot;top_n_per_article&quot;:1,&quot;unescape&quot;:false,&quot;preload&quot;:false}}</script><meta name="description" content="在我司的后台管理组件库pagurain、rsuite中要求实现换肤功能，以下是我们对这一功能实践的记录及过程。 前提为了统一各产品的视觉和操作体验，我们建立了UI规范体系，方便创建项目也方便统一管理。以扁平化和简洁为主旨的设计风格，使用块面来进行布局，用线条来表达各个控件，使功能庞杂的系统 既直观又条理清晰，让使用者一目了然。 主色及色阶系统共用的组件颜色和变化形式是统一的，在此基础上，各系统又有"><meta property="og:type" content="article"><meta property="og:title" content="less换肤功能实践"><meta property="og:url" content="http://hiyangguo.com/less-multiple-color-theme-realize/index.html"><meta property="og:site_name" content="Godfery的博客"><meta property="og:description" content="在我司的后台管理组件库pagurain、rsuite中要求实现换肤功能，以下是我们对这一功能实践的记录及过程。 前提为了统一各产品的视觉和操作体验，我们建立了UI规范体系，方便创建项目也方便统一管理。以扁平化和简洁为主旨的设计风格，使用块面来进行布局，用线条来表达各个控件，使功能庞杂的系统 既直观又条理清晰，让使用者一目了然。 主色及色阶系统共用的组件颜色和变化形式是统一的，在此基础上，各系统又有"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://hiyangguo.com/uploads/14900858020010.jpg"><meta property="og:image" content="http://hiyangguo.com/uploads/14900876640259.jpg"><meta property="og:image" content="http://hiyangguo.com/uploads/14900876785104.jpg"><meta property="article:published_time" content="2017-03-21T06:23:00.000Z"><meta property="article:modified_time" content="2022-06-20T13:30:49.363Z"><meta property="article:author" content="Godfery"><meta property="article:tag" content="less"><meta property="article:tag" content="grunt"><meta property="article:tag" content="多主题"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://hiyangguo.com/uploads/14900858020010.jpg"><link rel="canonical" href="http://hiyangguo.com/less-multiple-color-theme-realize/"><script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:false,&quot;isPost&quot;:true,&quot;lang&quot;:&quot;zh-CN&quot;,&quot;comments&quot;:true,&quot;permalink&quot;:&quot;http:&#x2F;&#x2F;hiyangguo.com&#x2F;less-multiple-color-theme-realize&#x2F;&quot;,&quot;path&quot;:&quot;less-multiple-color-theme-realize&#x2F;&quot;,&quot;title&quot;:&quot;less换肤功能实践&quot;}</script><script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script><title>less换肤功能实践 | Godfery的博客</title><script src="/js/config.js"></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">Godfery的博客</h1><i class="logo-line"></i></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fas fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fas fa-th fa-fw"></i>分类<span class="badge">11</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fas fa-archive fa-fw"></i>归档<span class="badge">22</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fas fa-tags fa-fw"></i>标签<span class="badge">33</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E6%8F%90"><span class="nav-number">1.</span> <span class="nav-text">前提</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E8%89%B2%E5%8F%8A%E8%89%B2%E9%98%B6"><span class="nav-number">1.1.</span> <span class="nav-text">主色及色阶</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9D%E6%AD%A5%E5%AE%9E%E7%8E%B0"><span class="nav-number">2.</span> <span class="nav-text">初步实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%94%B9%E8%BF%9B"><span class="nav-number">3.</span> <span class="nav-text">改进</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E6%AC%A1%E5%8F%AA%E4%BC%A0%E4%B8%80%E4%B8%AA%E9%A2%9C%E8%89%B2"><span class="nav-number">3.1.</span> <span class="nav-text">一次只传一个颜色</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%94%E6%8E%89grunt"><span class="nav-number">3.2.</span> <span class="nav-text">扔掉grunt</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93"><span class="nav-number">4.</span> <span class="nav-text">小结</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Godfery" src="/uploads/head.jpg"><p class="site-author-name" itemprop="name">Godfery</p><div class="site-description" itemprop="description">Godfery的博客</div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">22</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">11</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">33</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/hiyangguo" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hiyangguo" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://juejin.im/user/5651d4a860b2ed3620acfaed" title="掘金 → https:&#x2F;&#x2F;juejin.im&#x2F;user&#x2F;5651d4a860b2ed3620acfaed" rel="noopener" target="_blank"><i class="fas fa-code fa-fw"></i> 掘金</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://wangchujiang.com/FED/" title="https:&#x2F;&#x2F;wangchujiang.com&#x2F;FED&#x2F;" rel="noopener" target="_blank">JSDig</a></li><li class="links-of-blogroll-item"> <a href="https://docschina.org/" title="https:&#x2F;&#x2F;docschina.org&#x2F;" rel="noopener" target="_blank">印记中文</a></li><li class="links-of-blogroll-item"> <a href="http://www.alloyteam.com/nav/" title="http:&#x2F;&#x2F;www.alloyteam.com&#x2F;nav&#x2F;" rel="noopener" target="_blank">腾讯前端导航</a></li><li class="links-of-blogroll-item"> <a href="https://godbasin.github.io/front-end-playground/" title="https:&#x2F;&#x2F;godbasin.github.io&#x2F;front-end-playground&#x2F;" rel="noopener" target="_blank">被删的前端游乐场</a></li></ul></div></div></div></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/hiyangguo" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://hiyangguo.com/less-multiple-color-theme-realize/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/uploads/head.jpg"><meta itemprop="name" content="Godfery"><meta itemprop="description" content="Godfery的博客"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Godfery的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> less换肤功能实践</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2017-03-21 06:23:00" itemprop="dateCreated datePublished" datetime="2017-03-21T06:23:00+00:00">2017-03-21</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-06-20 13:30:49" itemprop="dateModified" datetime="2022-06-20T13:30:49+00:00">2022-06-20</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/less/" itemprop="url" rel="index"><span itemprop="name">less</span></a></span></span><span id="/less-multiple-color-theme-realize/" class="post-meta-item leancloud_visitors" data-flag-title="less换肤功能实践" title="阅读次数"><span class="post-meta-item-icon"><i class="far fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span class="leancloud-visitors-count"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Disqus：</span><a title="disqus" href="/less-multiple-color-theme-realize/#disqus_thread" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="less-multiple-color-theme-realize/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p>在我司的后台管理组件库<a target="_blank" rel="noopener" href="http://pagurain.com">pagurain</a>、<a target="_blank" rel="noopener" href="http://rsuite.github.io">rsuite</a>中要求实现换肤功能，以下是我们对这一功能实践的记录及过程。</p><h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><p>为了统一各产品的视觉和操作体验，我们建立了<a target="_blank" rel="noopener" href="http://pagurian.com/design/index.html">UI规范体系</a>，方便创建项目也方便统一管理。<br>以扁平化和简洁为主旨的设计风格，使用块面来进行布局，用线条来表达各个控件，使功能庞杂的系统 既直观又条理清晰，让使用者一目了然。</p><h3 id="主色及色阶"><a href="#主色及色阶" class="headerlink" title="主色及色阶"></a>主色及色阶</h3><p>系统共用的组件颜色和变化形式是统一的，在此基础上，各系统又有自己的主色调。</p><p>每套系统都会有一个主色，并在主色的基础上，在同一色调中扩充成一组完整的可复用的色彩体系，丰富系统配色。</p><p>如下图所示，每组色彩是按一定的规律在明度和饱和度上选取得出的。</p><p><img src="/uploads/14900858020010.jpg" alt=""></p><span id="more"></span><h2 id="初步实现"><a href="#初步实现" class="headerlink" title="初步实现"></a>初步实现</h2><p>按照上面的实现，我们的多套皮肤就是先定义一个主色 <code>@H500</code>，然后使用 <code>@H500</code> 这个颜色计算出其他的颜色，就搞定了。每次在不同的主题就换一套颜色。当然最终还是要生成多套颜色的<code>css</code>。<br>下面就按照这个思路开始吧。首先，我们按照设计师的要求定义一组颜色，如下：<br></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@H050:</span><span class="number">#e8f4ee</span>;</span><br><span class="line"><span class="variable">@H100:</span><span class="number">#bbdfcb</span>;</span><br><span class="line"><span class="variable">@H200:</span><span class="number">#8dcaa8</span>;</span><br><span class="line"><span class="variable">@H300:</span><span class="number">#67b88b</span>;</span><br><span class="line"><span class="variable">@H400:</span><span class="number">#41a66e</span>;</span><br><span class="line"><span class="variable">@H500:</span><span class="number">#1b9451</span>;</span><br><span class="line"><span class="variable">@H600:</span><span class="number">#188247</span>;</span><br><span class="line"><span class="variable">@H700:</span><span class="number">#146f3d</span>;</span><br><span class="line"><span class="variable">@H800:</span><span class="number">#115d33</span>;</span><br><span class="line"><span class="variable">@H900:</span><span class="number">#0e4a29</span>;</span><br></pre></td></tr></table></figure><br>这组颜色的计算规则如下:<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@H050:</span>darken(<span class="variable">@H500</span>,<span class="number">90%</span>);</span><br><span class="line"><span class="variable">@H100:</span>darken(<span class="variable">@H500</span>,<span class="number">70%</span>);</span><br><span class="line"><span class="variable">@H200:</span>darken(<span class="variable">@H500</span>,<span class="number">50%</span>);</span><br><span class="line"><span class="variable">@H300:</span>darken(<span class="variable">@H500</span>,<span class="number">33.3%</span>);</span><br><span class="line"><span class="variable">@H400:</span>darken(<span class="variable">@H500</span>,<span class="number">16.6%</span>);</span><br><span class="line"><span class="variable">@H500:</span><span class="number">#1b9451</span>;</span><br><span class="line"><span class="variable">@H600:</span>lighten(<span class="variable">@H500</span>,<span class="number">12.5%</span>);</span><br><span class="line"><span class="variable">@H700:</span>lighten(<span class="variable">@H500</span>,<span class="number">25%</span>);</span><br><span class="line"><span class="variable">@H800:</span>lighten(<span class="variable">@H500</span>,<span class="number">37.5%</span>);</span><br><span class="line"><span class="variable">@H900:</span>lighten(<span class="variable">@H500</span>,<span class="number">50%</span>);</span><br></pre></td></tr></table></figure><br>这猛一看挺简单啊，颜色的计算规则也有了，<code>less</code>也有相应的函数，这不很简单么。直接一算就出来了。<br>结果呢：<p></p><p>先用个绿色(<code>#1b9451</code>)试试</p><p><img src="/uploads/14900876640259.jpg" alt=""></p><p>换个蓝色(<code>#b3d1ff</code>)呢<br><img src="/uploads/14900876785104.jpg" alt=""></p><p>结果发现，如果颜色太深，那么<code>darken</code>后的颜色就是一堆黑色，如果颜色偏浅，那<code>lighten</code>后的颜色就是一堆白色。所以显然，使用<code>less</code>自带的颜色函数式不行的。那怎么办呢？<br>最简单的方法就是，现在外面算好了再复制进来，每次都复制10个颜色。计算颜色的方法，如下:<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Color utility functions</span></span><br><span class="line"><span class="comment"> * Source: http://stackoverflow.com/questions/5560248/programmatically-lighten-or-darken-a-hex-color-or-rgb-and-blend-colors</span></span><br><span class="line"><span class="comment"> * Github: https://github.com/mbitson/mcg</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shadeColor</span>(<span class="params">color, percent</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> f = <span class="built_in">parseInt</span>(color.slice(<span class="number">1</span>), <span class="number">16</span>),</span><br><span class="line">        t = percent &lt; <span class="number">0</span> ? <span class="number">0</span> : <span class="number">255</span>,</span><br><span class="line">        p = percent &lt; <span class="number">0</span> ? percent * -<span class="number">1</span> : percent,</span><br><span class="line">        R = f &gt;&gt; <span class="number">16</span>,</span><br><span class="line">        G = f &gt;&gt; <span class="number">8</span> &amp; <span class="number">0x00FF</span>,</span><br><span class="line">        B = f &amp; <span class="number">0x0000FF</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;#&quot;</span> + (<span class="number">0x1000000</span> + (<span class="built_in">Math</span>.round((t - R) * p) + R) * <span class="number">0x10000</span> + (<span class="built_in">Math</span>.round((t - G) * p) + G) * <span class="number">0x100</span> + (<span class="built_in">Math</span>.round((t - B) * p) + B)).toString(<span class="number">16</span>).slice(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>为此我们还特意做了一个页面来方便使用,<a target="_blank" rel="noopener" href="http://pagurian.com/demo/dist/templates/theme-color.html">页面链接</a><br>这样一来最起码的颜色就有了，我们只需先用这些变量生成一套基础的主题<code>base.less</code>，然后分别创建多个主题文件的<code>green.less</code>、<code>blue.less</code>，再分别覆盖这10个颜色变量，然后<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">&quot;base&quot;</span>; <span class="comment">//按照less 语法import less 可以省略文件ext</span></span><br></pre></td></tr></table></figure><br>最终就可以得到多套<code>css</code>了。<p></p><h2 id="改进"><a href="#改进" class="headerlink" title="改进"></a>改进</h2><h3 id="一次只传一个颜色"><a href="#一次只传一个颜色" class="headerlink" title="一次只传一个颜色"></a>一次只传一个颜色</h3><p>仅仅是那样，用肯定是没问题了，但是每次使用都要去生成配色的页面生成颜色，用着着实不爽。于是乎就想着能不能够有什么方法，自己去定义一个方法在less里直接调用。最终发现<code>grunt-contrib-less</code>这个插件有一个<code>customFunctions</code>方法,可以实现自定义方法，所以改进了一下。而且可以覆盖原有的变量，所以改进了一下，得到了如下代码<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//生成主题</span></span><br><span class="line">grunt.registerTask(<span class="string">&#x27;theme&#x27;</span>, <span class="string">&#x27;Generate theme&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.keys(themes).forEach(<span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> color = themes[name];</span><br><span class="line">        <span class="keyword">const</span> taskName = <span class="string">`theme-<span class="subst">$&#123;name&#125;</span>`</span>;</span><br><span class="line">        <span class="keyword">const</span> outputName = <span class="string">`src/resources/css/themes-<span class="subst">$&#123;name&#125;</span>.css`</span>;</span><br><span class="line">        grunt.config.merge(&#123;</span><br><span class="line">            less: &#123;</span><br><span class="line">                [taskName]: &#123;</span><br><span class="line">                    options: &#123;</span><br><span class="line">                        customFunctions: &#123;</span><br><span class="line">                            pallet</span><br><span class="line">                        &#125;,</span><br><span class="line">                        modifyVars: &#123;</span><br><span class="line">                            <span class="string">&#x27;base-color&#x27;</span>: color</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    files: &#123;</span><br><span class="line">                        [outputName]: <span class="string">&#x27;src/resources/less/theme/base.less&#x27;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        grunt.task.run(<span class="string">`less:<span class="subst">$&#123;taskName&#125;</span>`</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><br><a target="_blank" rel="noopener" href="https://github.com/hypers/pagurian/blob/dev/Gruntfile.js">源代码地址</a>;<p></p><h3 id="扔掉grunt"><a href="#扔掉grunt" class="headerlink" title="扔掉grunt"></a>扔掉<code>grunt</code></h3><p>但是这个时候问题又来了，因为这样做的话，就只能用<code>grunt</code>进行构建了，<code>gulp</code>构建或者<code>webpack</code>打包肯定不行啊（没有pallet方法）,那怎么办呢。一个<a target="_blank" rel="noopener" href="https://github.com/ant-design/ant-design/blob/734beb84ffc3f0469fbae1566aa8450f966cb261/components/style/color/colorPalette.less">偶然发现</a>使用less中的转义语法 <strong>~<code></code></strong> 居然可以执行js。简直了。然后经过测试使用这种hack方法可以成功的定义function，就解决了一切问题.<br></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.colorPaletteMixin</span> &#123;</span><br><span class="line">    <span class="variable">@functions:</span> ~`(function () &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * Color utility functions</span></span><br><span class="line"><span class="comment">     * Source: http://stackoverflow.com/questions/5560248/programmatically-lighten-or-darken-a-hex-color-or-rgb-and-blend-colors</span></span><br><span class="line"><span class="comment">     * Github: https://github.com/mbitson/mcg</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    var shadeColor = function (<span class="attribute">color</span>, percent) &#123;</span><br><span class="line">        var f = parseInt(<span class="attribute">color</span>.slice(<span class="number">1</span>), <span class="number">16</span>),</span><br><span class="line">            t = percent &lt; <span class="number">0</span> ? <span class="number">0</span> : <span class="number">255</span>,</span><br><span class="line">            p = percent &lt; <span class="number">0</span> ? percent * <span class="attribute">-1 </span>: percent,</span><br><span class="line">            R = f &gt;&gt; <span class="number">16</span>,</span><br><span class="line">            G = f &gt;&gt; <span class="number">8</span> &amp; <span class="number">0</span>x00FF,</span><br><span class="line">            B = f &amp; <span class="number">0</span>x0000FF;</span><br><span class="line">        return <span class="string">&quot;#&quot;</span> + (<span class="number">0</span>x1000000 + (Math.round((t - R) * p) + R) * <span class="number">0</span>x10000 + (Math.round((t - G) * p) + G) * <span class="number">0</span>x100 + (Math.round((t - B) * p) + B)).toString(<span class="number">16</span>).slice(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 计算系统颜色</span></span><br><span class="line"><span class="comment">     * @param color</span></span><br><span class="line"><span class="comment">     * @param percent (正值表示lighter,负值表示darken)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    this.pallet = function (<span class="attribute">color</span>, percent) &#123;</span><br><span class="line">        var colorConfig = &#123;</span><br><span class="line">            <span class="string">&#x27;50&#x27;</span>: <span class="number">0.9</span>,</span><br><span class="line">            <span class="string">&#x27;100&#x27;</span>: <span class="number">0.7</span>,</span><br><span class="line">            <span class="string">&#x27;200&#x27;</span>: <span class="number">0.5</span>,</span><br><span class="line">            <span class="string">&#x27;300&#x27;</span>: <span class="number">0.333</span>,</span><br><span class="line">            <span class="string">&#x27;400&#x27;</span>: <span class="number">0.166</span>,</span><br><span class="line">            <span class="string">&#x27;500&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="string">&#x27;600&#x27;</span>: -<span class="number">0.125</span>,</span><br><span class="line">            <span class="string">&#x27;700&#x27;</span>: -<span class="number">0.25</span>,</span><br><span class="line">            <span class="string">&#x27;800&#x27;</span>: -<span class="number">0.375</span>,</span><br><span class="line">            <span class="string">&#x27;900&#x27;</span>: -<span class="number">0.5</span></span><br><span class="line">        &#125;;</span><br><span class="line">        percent = colorConfig[percent] === undefined ? <span class="attribute">percent </span>: colorConfig[percent] ;</span><br><span class="line">        <span class="attribute">color</span> = <span class="attribute">color</span>.toLowerCase();</span><br><span class="line">        return shadeColor(<span class="attribute">color</span>, percent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()`;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// It is hacky way to make this function will be compiled preferentially by less</span></span><br><span class="line"><span class="selector-class">.colorPaletteMixin</span>();</span><br></pre></td></tr></table></figure><p></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>最后我只想说，写好文档太重要了，这里各种的坑，简直是踩也踩不完。说多了都是泪。安利一下我司的<code>react</code>组件库<a target="_blank" rel="noopener" href="http://rsuite.github.io/">rsuite</a>。l</p></div><div class="popular-posts-header">相关文章</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/webpack-mutiple-theme-solution-md/" rel="bookmark">webpack 换肤功能多主题/配色样式打包解决方案</a></div></li></ul><footer class="post-footer"><div class="reward-container"><div>坚持原创技术分享，您的支持将鼓励我继续创作！</div> <button onclick='document.querySelector(".post-reward").classList.toggle("active")'> 赞赏</button><div class="post-reward"><div> <img src="/path/to/wechat-reward-image.png" alt="Godfery 微信"> <span>微信</span></div><div> <img src="/path/to/alipay-reward-image.png" alt="Godfery 支付宝"> <span>支付宝</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>本文作者：</strong> Godfery</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="http://hiyangguo.com/less-multiple-color-theme-realize/" title="less换肤功能实践">http://hiyangguo.com/less-multiple-color-theme-realize/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode.zh-Hans" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="post-tags"> <a href="/tags/less/" rel="tag"># less</a> <a href="/tags/grunt/" rel="tag"># grunt</a> <a href="/tags/%E5%A4%9A%E4%B8%BB%E9%A2%98/" rel="tag"># 多主题</a></div><div class="post-nav"><div class="post-nav-item"><a href="/cross-tab-communication/" rel="prev" title="跨页面(tab/window)通信的几种方法"><i class="fa fa-chevron-left"></i> 跨页面(tab/window)通信的几种方法</a></div><div class="post-nav-item"> <a href="/use-express-build-proxy-pass/" rel="next" title="使用express实现反向代理服务器">使用express实现反向代理服务器<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="disqus_thread"><noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript></div><script src="/js/comments.js"></script></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2016 – <span itemprop="copyrightYear">2022</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Godfery</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动</div></div></footer><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/third-party/search/local-search.js"></script><script class="next-config" data-name="nprogress" type="application/json">{&quot;enable&quot;:true,&quot;spinner&quot;:true}</script><script src="/js/third-party/nprogress.js"></script><script class="next-config" data-name="leancloud_visitors" type="application/json">{&quot;enable&quot;:true,&quot;app_id&quot;:&quot;2jwVI58glS0nRFUd0v7YwmSE-gzGzoHsz&quot;,&quot;app_key&quot;:&quot;BrxDua0t4Dci3dlvkby5JuJo&quot;,&quot;server_url&quot;:&quot;https:&#x2F;&#x2F;2jwvi58g.lc-cn-n1-shared.com&quot;,&quot;security&quot;:false}</script><script src="/js/third-party/statistics/lean-analytics.js"></script><script src="https://cdn.jsdelivr.net/npm/quicklink@2.1.0/dist/quicklink.umd.js"></script><script class="next-config" data-name="quicklink" type="application/json">{&quot;enable&quot;:true,&quot;home&quot;:false,&quot;archive&quot;:false,&quot;delay&quot;:true,&quot;timeout&quot;:3000,&quot;priority&quot;:true,&quot;ignores&quot;:null,&quot;url&quot;:&quot;http:&#x2F;&#x2F;hiyangguo.com&#x2F;less-multiple-color-theme-realize&#x2F;&quot;}</script><script src="/js/third-party/quicklink.js"></script><script class="next-config" data-name="disqus" type="application/json">{&quot;enable&quot;:true,&quot;shortname&quot;:&quot;godeferyde-bo-ke&quot;,&quot;count&quot;:true,&quot;i18n&quot;:{&quot;disqus&quot;:&quot;disqus&quot;}}</script><script src="/js/third-party/comments/disqus.js"></script></body></html>