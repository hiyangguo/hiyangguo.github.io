<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css"><script src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js"></script><script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;hiyangguo.com&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Pisces&quot;,&quot;version&quot;:&quot;8.3.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12},&quot;copycode&quot;:true,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:true,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:true,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;fadeInDown&quot;,&quot;post_body&quot;:&quot;fadeInDown&quot;,&quot;coll_header&quot;:&quot;fadeInLeft&quot;,&quot;sidebar&quot;:&quot;fadeInUp&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;搜索...&quot;,&quot;empty&quot;:&quot;没有找到任何搜索结果：${query}&quot;,&quot;hits_time&quot;:&quot;找到 ${hits} 个搜索结果（用时 ${time} 毫秒）&quot;,&quot;hits&quot;:&quot;找到 ${hits} 个搜索结果&quot;},&quot;path&quot;:&quot;&#x2F;search.xml&quot;,&quot;localsearch&quot;:{&quot;enable&quot;:true,&quot;trigger&quot;:&quot;auto&quot;,&quot;top_n_per_article&quot;:1,&quot;unescape&quot;:false,&quot;preload&quot;:false}}</script><meta name="description" content="TypeScript 给 JavaScript 添加了一套静态类型系统，是为了保证类型安全的，也就是保证变量只能赋同类型的值，对象只能访问它有的属性、方法。但是这种类型安全的限制也不能太死板，有的时候需要一些变通，比如子类型是可以赋值给父类型的变量的，可以完全当成父类型来使用，也就是“型变（variant）”（类型改变）。这种“型变”分为两种，一种是子类型可以赋值给父类型，叫做协变（covaria"><meta property="og:type" content="article"><meta property="og:title" content="TypeScript 的协变、逆变、双向协变、不变"><meta property="og:url" content="http://hiyangguo.com/typescript-variant/index.html"><meta property="og:site_name" content="Godfery的博客"><meta property="og:description" content="TypeScript 给 JavaScript 添加了一套静态类型系统，是为了保证类型安全的，也就是保证变量只能赋同类型的值，对象只能访问它有的属性、方法。但是这种类型安全的限制也不能太死板，有的时候需要一些变通，比如子类型是可以赋值给父类型的变量的，可以完全当成父类型来使用，也就是“型变（variant）”（类型改变）。这种“型变”分为两种，一种是子类型可以赋值给父类型，叫做协变（covaria"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://hiyangguo.com/uploads/typescript-variant/strictFunctionTypes.png"><meta property="article:published_time" content="2022-06-20T21:09:12.000Z"><meta property="article:modified_time" content="2022-06-20T13:30:49.363Z"><meta property="article:author" content="Godfery"><meta property="article:tag" content="TypeScript"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://hiyangguo.com/uploads/typescript-variant/strictFunctionTypes.png"><link rel="canonical" href="http://hiyangguo.com/typescript-variant/"><script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:false,&quot;isPost&quot;:true,&quot;lang&quot;:&quot;zh-CN&quot;,&quot;comments&quot;:true,&quot;permalink&quot;:&quot;http:&#x2F;&#x2F;hiyangguo.com&#x2F;typescript-variant&#x2F;&quot;,&quot;path&quot;:&quot;typescript-variant&#x2F;&quot;,&quot;title&quot;:&quot;TypeScript 的协变、逆变、双向协变、不变&quot;}</script><script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script><title>TypeScript 的协变、逆变、双向协变、不变 | Godfery的博客</title><script src="/js/config.js"></script><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">Godfery的博客</h1><i class="logo-line"></i></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fas fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fas fa-th fa-fw"></i>分类<span class="badge">11</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fas fa-archive fa-fw"></i>归档<span class="badge">22</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fas fa-tags fa-fw"></i>标签<span class="badge">33</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%8F%E5%8F%98"><span class="nav-number">1.</span> <span class="nav-text">协变</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%86%E5%8F%98"><span class="nav-number">2.</span> <span class="nav-text">逆变</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8C%E5%90%91%E5%8D%8F%E5%8F%98"><span class="nav-number">3.</span> <span class="nav-text">双向协变</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E5%8F%98"><span class="nav-number">4.</span> <span class="nav-text">不变</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">5.</span> <span class="nav-text">参考</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Godfery" src="/uploads/head.jpg"><p class="site-author-name" itemprop="name">Godfery</p><div class="site-description" itemprop="description">Godfery的博客</div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">22</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">11</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">33</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/hiyangguo" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hiyangguo" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://juejin.im/user/5651d4a860b2ed3620acfaed" title="掘金 → https:&#x2F;&#x2F;juejin.im&#x2F;user&#x2F;5651d4a860b2ed3620acfaed" rel="noopener" target="_blank"><i class="fas fa-code fa-fw"></i> 掘金</a></span></div><div class="links-of-blogroll site-overview-item animated"><div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://wangchujiang.com/FED/" title="https:&#x2F;&#x2F;wangchujiang.com&#x2F;FED&#x2F;" rel="noopener" target="_blank">JSDig</a></li><li class="links-of-blogroll-item"> <a href="https://docschina.org/" title="https:&#x2F;&#x2F;docschina.org&#x2F;" rel="noopener" target="_blank">印记中文</a></li><li class="links-of-blogroll-item"> <a href="http://www.alloyteam.com/nav/" title="http:&#x2F;&#x2F;www.alloyteam.com&#x2F;nav&#x2F;" rel="noopener" target="_blank">腾讯前端导航</a></li><li class="links-of-blogroll-item"> <a href="https://godbasin.github.io/front-end-playground/" title="https:&#x2F;&#x2F;godbasin.github.io&#x2F;front-end-playground&#x2F;" rel="noopener" target="_blank">被删的前端游乐场</a></li></ul></div></div></div></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/hiyangguo" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://hiyangguo.com/typescript-variant/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/uploads/head.jpg"><meta itemprop="name" content="Godfery"><meta itemprop="description" content="Godfery的博客"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Godfery的博客"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> TypeScript 的协变、逆变、双向协变、不变</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-06-20 21:09:12 / 修改时间：13:30:49" itemprop="dateCreated datePublished" datetime="2022-06-20T21:09:12+00:00">2022-06-20</time></span><span id="/typescript-variant/" class="post-meta-item leancloud_visitors" data-flag-title="TypeScript 的协变、逆变、双向协变、不变" title="阅读次数"><span class="post-meta-item-icon"><i class="far fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span class="leancloud-visitors-count"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">Disqus：</span><a title="disqus" href="/typescript-variant/#disqus_thread" itemprop="discussionUrl"><span class="post-comments-count disqus-comment-count" data-disqus-identifier="typescript-variant/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p><code>TypeScript</code> 给 <code>JavaScript</code> 添加了一套静态类型系统，是为了保证类型安全的，也就是保证变量只能赋同类型的值，对象只能访问它有的属性、方法。<br>但是这种类型安全的限制也不能太死板，有的时候需要一些变通，比如子类型是可以赋值给父类型的变量的，可以完全当成父类型来使用，也就是“<strong>型变（variant）</strong>”（<strong>类型改变</strong>）。<br>这种“型变”分为两种，一种是子类型可以赋值给父类型，叫做<strong>协变（covariant）</strong>，一种是父类型可以赋值给子类型，叫做<strong>逆变（contravariant）</strong>。</p><span id="more"></span><h3 id="协变"><a href="#协变" class="headerlink" title="协变"></a>协变</h3><p>子类型可以赋值给父类型的情况就叫做<strong>协变（covariant）</strong>。</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Person &#123;</span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Student &#123;</span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">  subjects: <span class="built_in">string</span>[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person: Person = &#123;</span><br><span class="line">  name: <span class="string">&#x27;xaioming&#x27;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> zhangsan: Student = &#123;</span><br><span class="line">  name: <span class="string">&#x27;zhangsan&#x27;</span>,</span><br><span class="line">  subjects: [<span class="string">&#x27;HTML&#x27;</span>, <span class="string">&#x27;JavaScript&#x27;</span>],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">person = zhangsan; <span class="comment">// 这里发生了协变</span></span><br></pre></td></tr></table></figure><p><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/play?strictFunctionTypes=false&amp;ts=4.5.0-beta#code/JYOwLgpgTgZghgYwgAgArQM4HsTIN4BQyxyIcAthAFzIZhSgDmA3AQL7IEGiSyIoBlMAFcAJhHD4iJMpRp0GIFtOIZhAIwBWEBGAzz6TANoBddlwA2EMMgAOmHDXRRsuALxSSpCtWQByAA84YCxyJj8AGnZWKxsALwALOCUMZJohMQkbD0IvWV8-ROTGVJBIlVoNbV19ZCM-AAkAFQBZABlI-wApOAA3OAEEBlswPzM2VgJ7FxxkDyKU5OZkAHoV5EBN+MAZxMBF5UB8V0AwuUB5ZUAN5SA">试一下</a></p><h3 id="逆变"><a href="#逆变" class="headerlink" title="逆变"></a>逆变</h3><p>函数的参数有<strong>逆变（contravariant）</strong>的性质，即拥有父类型参数的函数可以赋值给子类型的函数。而返回值是<strong>协变</strong>的，也就是子类型可以赋值给父类型。</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Person &#123;</span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> Student &#123;</span><br><span class="line">  name: <span class="built_in">string</span>;</span><br><span class="line">  subjects: <span class="built_in">string</span>[];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> printSubjects = <span class="function">(<span class="params">student: Student</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(student.subjects);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> printName = <span class="function">(<span class="params">person: Person</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(person.name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">printSubjects = printName; <span class="comment">// 这里由于参数的逆变性质 可以进行赋值</span></span><br><span class="line">printName = printSubjects; <span class="comment">// Type &#x27;(student: Student) =&gt; void&#x27; is not assignable to type &#x27;(person: Person) =&gt; void&#x27;.</span></span><br><span class="line"><span class="comment">// Types of parameters &#x27;student&#x27; and &#x27;person&#x27; are incompatible.</span></span><br><span class="line"><span class="comment">// Property &#x27;subjects&#x27; is missing in type &#x27;Person&#x27; but required in type &#x27;Student&#x27;.(2322)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person: Person = &#123;</span><br><span class="line">  name: <span class="string">&#x27;xaioming&#x27;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> zhangsan: Student = &#123;</span><br><span class="line">  name: <span class="string">&#x27;zhangsan&#x27;</span>,</span><br><span class="line">  subjects: [<span class="string">&#x27;HTML&#x27;</span>, <span class="string">&#x27;JavaScript&#x27;</span>],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> getStudent = (): <span class="function"><span class="params">Student</span> =&gt;</span> zhangsan;</span><br><span class="line"><span class="keyword">let</span> getPerson = (): <span class="function"><span class="params">Person</span> =&gt;</span> person;</span><br><span class="line"></span><br><span class="line">getPerson = getStudent; <span class="comment">//这里由于函数返回值是协变的 可以进行赋值</span></span><br></pre></td></tr></table></figure><p><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/play?ts=4.5.0-beta#code/JYOwLgpgTgZghgYwgAgArQM4HsTIN4BQyxyIcAthAFzIZhSgDmA3AQL7IEGiSyIoBlMAFcAJhHD4iJMpRp0GIFtOIZhAIwBWEBGAzz6TANoBddlwA2EMMgAOisAI3bd+5AAo6YiWBpDv4ACUyAC8AHzIAG5YwKKsBPY8Tlo6eqEeXuJBoRGEJMgIONhWAHQWWIyeIllgJWoproGsbJbWdg4AchTUHraYODToUNggweFRMXFcieBdlOnufcM4Y7kqBUVYpeWVSyMlshBN5gkOyS5pIe08cxDMyAD0D8iAm-GAM4mAjK6AcXKAQ8qADqaAELdAGAJgA3lQDkBoAKWOQgHvlQCncoBt+MAMhGAaVjADwKpxu3XSM0czlSGHurRsewGaH6uCueRk3RoAHIAB5wYBYchMWkAGnYrCsNgAXgALOBKDBCvzVHzpKnEQ50gVCxgikAc9b1C5uIy0gASABUALIAGQ5yFpACk4JE4AIEAxbGBaWY2PEechGNZ-DUFoEqO6JeM5cKhdy2q6wEMRsQru4vWGcDk7OT4iGYxSXW7xeBWEA">试一下</a></p><h3 id="双向协变"><a href="#双向协变" class="headerlink" title="双向协变"></a>双向协变</h3><p>在 <strong>ts2.x</strong> 之前支持有父类型参数的函数可以赋值给子类型的函数<strong>（协变）</strong>，同时有子类型参数的函数可以赋值给父类型的函数<strong>（逆变）</strong>。这种特性成为“<strong>双向协变</strong>”。</p><p>但是这明显是<strong>有问题的</strong>，不能保证类型安全，所以之后 ts 加了一个编译选项 <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/tsconfig#strictFunctionTypes"><code>strictFunctionTypes</code></a>，设置为 <code>true</code> 就只支持函数参数的逆变，设置为 <code>false</code> 则支持双向协变。</p><p><img src="/uploads/typescript-variant/strictFunctionTypes.png" alt="strictFunctionTypes"></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">printName = printSubjects; <span class="comment">// 将 strictFunctionTypes 设为 false 后，支持函数参数的双向协变，类型检查不会报错，但不能严格保证类型安全。</span></span><br></pre></td></tr></table></figure><p><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/play?strictFunctionTypes=false&amp;ts=4.5.0-beta#code/JYOwLgpgTgZghgYwgAgArQM4HsTIN4BQyxyIcAthAFzIZhSgDmA3AQL7IEGiSyIoBlMAFcAJhHD4iJMpRp0GIFtOIZhAIwBWEBGAzz6TANoBddlwA2EMMgAOisAI3bd+5AAo6YiWBpDv4ACUyAC8AHzIAG5YwKKsBPY8Tlo6eqEeXuJBoRGEJMgIONhWAHQWWIyeIllgJWoproGsbJbWdg4AchTUHraYODToUNggweFRMXFcieBdlOnufcM4Y7kqBUVYpeWVSyMlshBN5gkOyS5pIe08cxDMyAD0D8iAm-GAM4mAjK6AcXKAQ8qADqaAELdAGAJgA3lQDkBoAKWOQgHvlQCncoBt+MAMhGAaVjADwKpxu3XSM0czlSGHuT2QgDAdWiGXQAMWEIF0wBwABUAJ59DDIQB90YAuOWQ8AsGBQgDgVQAw-99ADPKgEQVUGCuFowBhckA">试一下</a></p><h3 id="不变"><a href="#不变" class="headerlink" title="不变"></a>不变</h3><p>型变都是针对父子类型来说的，非父子类型就不会型变也就是<strong>不变（invariant）</strong>。</p><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul><li><a target="_blank" rel="noopener" href="https://juejin.cn/book/7047524421182947366">TypeScript 类型体操通关秘籍</a></li></ul></div><div class="popular-posts-header">相关文章</div><ul class="popular-posts"><li class="popular-posts-item"><div class="popular-posts-title"><a href="/typescirpt-guide/" rel="bookmark">TypeScript 指南</a></div></li></ul><footer class="post-footer"><div class="reward-container"><div>坚持原创技术分享，您的支持将鼓励我继续创作！</div> <button onclick='document.querySelector(".post-reward").classList.toggle("active")'> 赞赏</button><div class="post-reward"><div> <img src="/path/to/wechat-reward-image.png" alt="Godfery 微信"> <span>微信</span></div><div> <img src="/path/to/alipay-reward-image.png" alt="Godfery 支付宝"> <span>支付宝</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>本文作者：</strong> Godfery</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="http://hiyangguo.com/typescript-variant/" title="TypeScript 的协变、逆变、双向协变、不变">http://hiyangguo.com/typescript-variant/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode.zh-Hans" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="post-tags"> <a href="/tags/TypeScript/" rel="tag"># TypeScript</a></div><div class="post-nav"><div class="post-nav-item"><a href="/typescirpt-guide/" rel="prev" title="TypeScript 指南"><i class="fa fa-chevron-left"></i> TypeScript 指南</a></div><div class="post-nav-item"></div></div></footer></article></div><div class="comments" id="disqus_thread"><noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript></div><script src="/js/comments.js"></script></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> &copy; 2016 – <span itemprop="copyrightYear">2022</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Godfery</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动</div></div></footer><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/third-party/search/local-search.js"></script><script class="next-config" data-name="nprogress" type="application/json">{&quot;enable&quot;:true,&quot;spinner&quot;:true}</script><script src="/js/third-party/nprogress.js"></script><script class="next-config" data-name="leancloud_visitors" type="application/json">{&quot;enable&quot;:true,&quot;app_id&quot;:&quot;2jwVI58glS0nRFUd0v7YwmSE-gzGzoHsz&quot;,&quot;app_key&quot;:&quot;BrxDua0t4Dci3dlvkby5JuJo&quot;,&quot;server_url&quot;:&quot;https:&#x2F;&#x2F;2jwvi58g.lc-cn-n1-shared.com&quot;,&quot;security&quot;:false}</script><script src="/js/third-party/statistics/lean-analytics.js"></script><script src="https://cdn.jsdelivr.net/npm/quicklink@2.1.0/dist/quicklink.umd.js"></script><script class="next-config" data-name="quicklink" type="application/json">{&quot;enable&quot;:true,&quot;home&quot;:false,&quot;archive&quot;:false,&quot;delay&quot;:true,&quot;timeout&quot;:3000,&quot;priority&quot;:true,&quot;ignores&quot;:null,&quot;url&quot;:&quot;http:&#x2F;&#x2F;hiyangguo.com&#x2F;typescript-variant&#x2F;&quot;}</script><script src="/js/third-party/quicklink.js"></script><script class="next-config" data-name="disqus" type="application/json">{&quot;enable&quot;:true,&quot;shortname&quot;:&quot;godeferyde-bo-ke&quot;,&quot;count&quot;:true,&quot;i18n&quot;:{&quot;disqus&quot;:&quot;disqus&quot;}}</script><script src="/js/third-party/comments/disqus.js"></script></body></html>